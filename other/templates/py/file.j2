# -*- coding: utf-8 -*-
# DO NOT EDIT! This file is auto-generated from
# https://github.com/mavlink/MAVSDK-Python/tree/main/other/templates/py
from ._base import AsyncBase
from . import {{ plugin_name.lower_snake_case }}_pb2, {{ plugin_name.lower_snake_case }}_pb2_grpc
from enum import Enum

{%- for enum in enums %}


{{ enum }}
{%- endfor %}


{%- for struct in structs %}


{{ struct }}
{%- endfor %}


{% if has_result %}
class {{ plugin_name.upper_camel_case }}Error(Exception):
    """ Raised when a {{ plugin_name.upper_camel_case }}Result is a fail code """

    def __init__(self, result, origin, *params):
        self._result = result
        self._origin = origin
        self._params = params

    def __str__(self):
        return f"{self._result.result}: '{self._result.result_str}'; origin: {self._origin}; params: {self._params}"
{% endif %}

class {{ plugin_name.upper_camel_case }}(AsyncBase):
    """
 {{ indent(class_description, 1) }}

     Generated by dcsdkgen - MAVSDK {{ plugin_name.upper_camel_case }} API
    """

    # Plugin name
    name = "{{ plugin_name.upper_camel_case }}"

    def _setup_stub(self, channel):
        """ Setups the api stub """
        self._stub = {{ plugin_name.lower_snake_case }}_pb2_grpc.{{ plugin_name.upper_camel_case }}ServiceStub(channel)

    {% if has_result %}
    def _extract_result(self, response):
        """ Returns the response status and description """
        return {{ plugin_name.upper_camel_case }}Result.translate_from_rpc(response.{{ plugin_name.lower_snake_case }}_result)
    {% endif %}

    {%- for method in methods -%}
    {{ '\n' + indent(method, 1) }}

    {%- endfor %}
